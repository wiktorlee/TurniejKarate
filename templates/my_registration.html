{% extends "base.html" %}
{% block content %}
<h1>Moje zgłoszenia</h1>

<div class="card">
{% if registrations and registrations|length > 0 %}
  {% for reg in registrations %}
    <div style="margin-bottom: 24px; padding: 16px; background: #f9f9f9; border-radius: 8px; border: 1px solid #ddd;">
      <h3 style="margin-top: 0; margin-bottom: 12px;">{{ reg.event_name or 'Brak nazwy eventu' }}</h3>
      
      {% if reg.start_date or reg.end_date %}
        <p style="margin-bottom: 8px; color: #666;">
          <b>Termin:</b> 
          {% if reg.start_date and reg.end_date %}
            {{ reg.start_date.strftime('%d.%m.%Y') }} - {{ reg.end_date.strftime('%d.%m.%Y') }}
          {% elif reg.start_date %}
            {{ reg.start_date.strftime('%d.%m.%Y') }}
          {% elif reg.end_date %}
            do {{ reg.end_date.strftime('%d.%m.%Y') }}
          {% endif %}
        </p>
      {% endif %}
      
      <div style="margin-top: 12px;">
        {% if reg.kata_name %}
          <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 4px;">
            <p style="margin: 0;"><b>Kata:</b> {{ reg.kata_name }}</p>
            <form method="post" action="{{ url_for('registration.withdraw_discipline') }}" style="display: inline; margin-top: 8px;">
              <input type="hidden" name="registration_id" value="{{ reg.reg_id }}">
              <input type="hidden" name="discipline_type" value="kata">
              <button type="submit" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.9em;">
                Wycofaj z Kata
              </button>
            </form>
          </div>
        {% endif %}
        
        {% if reg.kumite_name %}
          <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 4px;">
            <p style="margin: 0;"><b>Kumite:</b> {{ reg.kumite_name }}</p>
            <form method="post" action="{{ url_for('registration.withdraw_discipline') }}" style="display: inline; margin-top: 8px;">
              <input type="hidden" name="registration_id" value="{{ reg.reg_id }}">
              <input type="hidden" name="discipline_type" value="kumite">
              <button type="submit" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.9em;">
                Wycofaj z Kumite
              </button>
            </form>
          </div>
        {% endif %}
      </div>
      
      <form method="post" action="{{ url_for('registration.withdraw') }}" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #ddd;">
        <input type="hidden" name="registration_id" value="{{ reg.reg_id }}">
        <button type="submit" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9em;">
          Wycofaj całe zgłoszenie na ten event
        </button>
      </form>
    </div>
  {% endfor %}
  
  <p style="margin-top: 16px;">
    <a href="{{ url_for('categories.categories') }}">Zapisz się na kolejne zawody</a>
  </p>
{% else %}
  <p>Nie jesteś jeszcze zapisany do żadnej kategorii.</p>
  <a href="{{ url_for('categories.categories') }}">Zapisz się teraz</a>
{% endif %}
</div>
{% endblock %}